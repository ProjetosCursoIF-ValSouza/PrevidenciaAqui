-- MySQL Script generated by MySQL Workbench
-- Thu May 18 16:59:19 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema previdenciaaquidb
-- -----------------------------------------------------
DROP SCHEMA`previdenciaaquidb`;
-- -----------------------------------------------------
-- Schema previdenciaaquidb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `previdenciaaquidb` DEFAULT CHARACTER SET utf8 ;
USE `previdenciaaquidb` ;

-- -----------------------------------------------------
-- Table `previdenciaaquidb`.`simulacao_beneficio`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `previdenciaaquidb`.`simulacao_beneficio` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `genero` ENUM('m', 'f') NOT NULL,
  `data_nascimento` DATE NOT NULL,
  `idade` INT NULL,
  `tempo_contribuicao_mes` INT NULL,
  `idade_aposentadoria` INT NULL,
  `mes_aposentadoria` INT NULL,
  `ano_aposentadoria` INT NULL,
  `tempo_contribuicao_pendente_mes` INT NULL,
  `valor_beneficio` DECIMAL(10,2) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `previdenciaaquidb`.`simulacao_periodo_trabalho`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `previdenciaaquidb`.`simulacao_periodo_trabalho` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `mes` INT NOT NULL,
  `ano` INT NOT NULL,
  `salario` DECIMAL(10,2) NOT NULL,
   mes_ano VARCHAR(7) NOT NULL,
   salario_atualizado DECIMAL(10,2) NOT NULL,
  `simulacao_beneficio_id` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_simulacao_periodo_trabalho_simulacao_beneficio_idx` (`simulacao_beneficio_id` ASC),
  CONSTRAINT `fk_simulacao_periodo_trabalho_simulacao_beneficio`
    FOREIGN KEY (`simulacao_beneficio_id`)
    REFERENCES `previdenciaaquidb`.`simulacao_beneficio` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS atualizacao_monetaria (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  mes_ano VARCHAR(10) NULL,
  indice_atualizacao DECIMAL(10,6) NOT NULL,
  PRIMARY KEY (id)
) ENGINE = InnoDB;

INSERT INTO atualizacao_monetaria (mes_ano, indice_atualizacao) VALUES
('jul/94', '10.496220'),
('ago/94', '9.894625'),
('set/94', '9.382343'),
('out/94', '9.242786'),
('nov/94', '9.074008'),
('dez/94', '8.786683'),
('jan/95', '8.598378'),
('fev/95', '8.457139'),
('mar/95', '8.374236'),
('abr/95', '8.257799'),
('mai/95', '8.102239'),
('jun/95', '7.899228'),
('jul/95', '7.758035'),
('ago/95', '7.571765'),
('set/95', '7.495315'),
('out/95', '7.408634'),
('nov/95', '7.306342'),
('dez/95', '7.197660'),
('jan/96', '7.080825'),
('fev/96', '6.978939'),
('mar/96', '6.929731'),
('abr/96', '6.909696'),
('mai/96', '6.861663'),
('jun/96', '6.748289'),
('jul/96', '6.666957'),
('ago/96', '6.595070'),
('set/96', '6.594801'),
('out/96', '6.586242'),
('nov/96', '6.571784'),
('dez/96', '6.553436'),
('jan/97', '6.496265'),
('fev/97', '6.395223'),
('mar/97', '6.368471'),
('abr/97', '6.295450'),
('mai/97', '6.258521'),
('jun/97', '6.239805'),
('jul/97', '6.196431'),
('ago/97', '6.190859'),
('set/97', '6.190859'),
('out/97', '6.154543'),
('nov/97', '6.133689'),
('dez/97', '6.083198'),
('jan/98', '6.041513'),
('fev/98', '5.988816'),
('mar/98', '5.987616'),
('abr/98', '5.973874'),
('mai/98', '5.973874'),
('jun/98', '5.960167'),
('jul/98', '5.943521'),
('ago/98', '5.943521'),
('set/98', '5.943521'),
('out/98', '5.943521'),
('nov/98', '5.943521'),
('dez/98', '5.943521'),
('jan/99', '5.885848'),
('fev/99', '5.818919'),
('mar/99', '5.571547'),
('abr/99', '5.525364'),
('mai/99', '5.407877'),
('jun/99', '5.407877'),
('jul/99', '5.407877'),
('ago/99', '5.407877'),
('set/99', '5.375501'),
('out/99', '5.375501'),
('nov/99', '5.347567'),
('dez/99', '5.347567'),
('jan/00', '5.256715'),
('fev/00', '5.256715'),
('mar/00', '5.256715'),
('abr/00', '5.256715'),
('mai/00', '5.202839'),
('jun/00', '5.148792'),
('jul/00', '5.118993'),
('ago/00', '5.091561'),
('set/00', '5.091561'),
('out/00', '5.063287'),
('nov/00', '5.037244'),
('dez/00', '5.012708'),
('jan/01', '4.943549'),
('fev/01', '4.886285'),
('mar/01', '4.839291'),
('abr/01', '4.839291'),
('mai/01', '4.793851'),
('jun/01', '4.758378'),
('jul/01', '4.737804'),
('ago/01', '4.726187'),
('set/01', '4.715849'),
('out/01', '4.703690'),
('nov/01', '4.688963'),
('dez/01', '4.675649'),
('jan/02', '4.666405'),
('fev/02', '4.646091'),
('mar/02', '4.615792'),
('abr/02', '4.615792'),
('mai/02', '4.591017'),
('jun/02', '4.573280'),
('jul/02', '4.563877'),
('ago/02', '4.559262'),
('set/02', '4.549116'),
('out/02', '4.535383'),
('nov/02', '4.520122'),
('dez/02', '4.503519'),
('jan/03', '4.495288'),
('fev/03', '4.473436'),
('mar/03', '4.448577'),
('abr/03', '4.448577'),
('mai/03', '4.420585'),
('jun/03', '4.399784'),
('jul/03', '4.386081'),
('ago/03', '4.375876'),
('set/03', '4.359105'),
('out/03', '4.341999'),
('nov/03', '4.322766'),
('dez/03', '4.301366'),
('jan/04', '4.291470'),
('fev/04', '4.267085'),
('mar/04', '4.245625'),
('abr/04', '4.245625'),
('mai/04', '4.220441'),
('jun/04', '4.193879'),
('jul/04', '4.175442'),
('ago/04', '4.163974'),
('set/04', '4.147280'),
('out/04', '4.130290'),
('nov/04', '4.111071'),
('dez/04', '4.089206'),
('jan/05', '4.076408'),
('fev/05', '4.054250'),
('mar/05', '4.028826'),
('abr/05', '4.028826'),
('mai/05', '4.002135'),
('jun/05', '3.973850'),
('jul/05', '3.955755'),
('ago/05', '3.941754'),
('set/05', '3.928085'),
('out/05', '3.915758'),
('nov/05', '3.897286'),
('dez/05', '3.874953'),
('jan/06', '3.859607'),
('fev/06', '3.839218'),
('mar/06', '3.815107'),
('abr/06', '3.815107'),
('mai/06', '3.792006'),
('jun/06', '3.760848'),
('jul/06', '3.741276'),
('ago/06', '3.733771'),
('set/06', '3.726007'),
('out/06', '3.717092'),
('nov/06', '3.708424'),
('dez/06', '3.700185'),
('jan/07', '3.690364'),
('fev/07', '3.680072'),
('mar/07', '3.669312'),
('abr/07', '3.669312'),
('mai/07', '3.657966'),
('jun/07', '3.645598'),
('jul/07', '3.640179'),
('ago/07', '3.634520'),
('set/07', '3.628175'),
('out/07', '3.621122'),
('nov/07', '3.613324'),
('dez/07', '3.604722'),
('jan/08', '3.597764'),
('fev/08', '3.588993'),
('mar/08', '3.579878'),
('abr/08', '3.579878'),
('mai/08', '3.569664'),
('jun/08', '3.560310'),
('jul/08', '3.552460'),
('ago/08', '3.545077'),
('set/08', '3.536616'),
('out/08', '3.528228'),
('nov/08', '3.519701'),
('dez/08', '3.510987'),
('jan/09', '3.502454'),
('fev/09', '3.493975'),
('mar/09', '3.485417'),
('abr/09', '3.485417'),
('mai/09', '3.475452'),
('jun/09', '3.466660'),
('jul/09', '3.459530'),
('ago/09', '3.452211'),
('set/09', '3.444127'),
('out/09', '3.435957'),
('nov/09', '3.427826'),
('dez/09', '3.418450'),
('jan/10', '3.409978'),
('fev/10', '3.400845'),
('mar/10', '3.392111'),
('abr/10', '3.392111'),
('mai/10', '3.381585'),
('jun/10', '3.371686'),
('jul/10', '3.364351'),
('ago/10', '3.356929'),
('set/10', '3.349255'),
('out/10', '3.341725'),
('nov/10', '3.334537'),
('dez/10', '3.327171'),
('jan/11', '3.320024'),
('fev/11', '3.313333'),
('mar/11', '3.306577'),
('abr/11', '3.306577'),
('mai/11', '3.297730'),
('jun/11', '3.288505'),
('jul/11', '3.282070'),
('ago/11', '3.275459'),
('set/11', '3.268891'),
('out/11', '3.262283'),
('nov/11', '3.255987'),
('dez/11', '3.249772'),
('jan/12', '3.243297'),
('fev/12', '3.236535'),
('mar/12', '3.229695'),
('abr/12', '3.229695'),
('mai/12', '3.221944'),
('jun/12', '3.214117'),
('jul/12', '3.207338'),
('ago/12', '3.200494'),
('set/12', '3.193791'),
('out/12', '3.187205'),
('nov/12', '3.180610'),
('dez/12', '3.173885'),
('jan/13', '3.167454'),
('fev/13', '3.160786'),
('mar/13', '3.154196'),
('abr/13', '3.154196'),
('mai/13', '3.147741'),
('jun/13', '3.141197'),
('jul/13', '3.135381'),
('ago/13', '3.129541'),
('set/13', '3.123708'),
('out/13', '3.117753'),
('nov/13', '3.111896'),
('dez/13', '3.105957'),
('jan/14', '3.100034'),
('fev/14', '3.094037'),
('mar/14', '3.088139'),
('abr/14', '3.088139'),
('mai/14', '3.081483'),
('jun/14', '3.074898'),
('jul/14', '3.069097'),
('ago/14', '3.063133'),
('set/14', '3.057305'),
('out/14', '3.051364'),
('nov/14', '3.045425'),
('dez/14', '3.039425'),
('jan/15', '3.033494'),
('fev/15', '3.027478'),
('mar/15', '3.021613'),
('abr/15', '3.021613'),
('mai/15', '3.015917'),
('jun/15', '3.010220'),
('jul/15', '3.004543'),
('ago/15', '2.998785'),
('set/15', '2.993157'),
('out/15', '2.987395'),
('nov/15', '2.981682'),
('dez/15', '2.975877'),
('jan/16', '2.970097'),
('fev/16', '2.964391'),
('mar/16', '2.958621'),
('abr/16', '2.958621'),
('mai/16', '2.952892'),
('jun/16', '2.947192'),
('jul/16', '2.941501'),
('ago/16', '2.935772'),
('set/16', '2.930080'),
('out/16', '2.924335'),
('nov/16', '2.918576'),
('dez/16', '2.912824'),
('jan/17', '2.907097'),
('fev/17', '2.901395'),
('mar/17', '2.895621'),
('abr/17', '2.895621'),
('mai/17', '2.889928'),
('jun/17', '2.884151'),
('jul/17', '2.878396'),
('ago/17', '2.872715'),
('set/17', '2.867030'),
('out/17', '2.861254'),
('nov/17', '2.855492'),
('dez/17', '2.849839'),
('jan/18', '2.844152'),
('fev/18', '2.838470'),
('mar/18', '2.832710'),
('abr/18', '2.832710'),
('mai/18', '2.827029'),
('jun/18', '2.821348'),
('jul/18', '2.815678'),
('ago/18', '2.809982'),
('set/18', '2.804298'),
('out/18', '2.798618'),
('nov/18', '2.792961'),
('dez/18', '2.787318'),
('jan/19', '2.781694'),
('fev/19', '2.776029'),
('mar/19', '2.770378'),
('abr/19', '2.770378'),
('mai/19', '2.764733'),
('jun/19', '2.759090'),
('jul/19', '2.753461'),
('ago/19', '2.747815'),
('set/19', '2.742191'),
('out/19', '2.736588'),
('nov/19', '2.730977'),
('dez/19', '2.725380'),
('jan/20', '2.719809'),
('fev/20', '2.714207'),
('mar/20', '2.708610'),
('abr/20', '2.708610'),
('mai/20', '2.703030'),
('jun/20', '2.697444'),
('jul/20', '2.691885'),
('ago/20', '2.686312'),
('set/20', '2.680734'),
('out/20', '2.675175'),
('nov/20', '2.669628'),
('dez/20', '2.664082'),
('jan/21', '2.658555'),
('fev/21', '2.653004'),
('mar/21', '2.647479'),
('abr/21', '2.647479'),
('mai/21', '2.641957'),
('jun/21', '2.636440'),
('jul/21', '2.630929'),
('ago/21', '2.625424'),
('set/21', '2.619937'),
('out/21', '2.614446'),
('nov/21', '2.608970'),
('dez/21', '2.603496'),
('jan/22', '2.598037'),
('fev/22', '2.592572'),
('mar/22', '2.587130'),
('abr/22', '2.587130'),
('mai/22', '2.581704'),
('jun/22', '2.576283'),
('jul/22', '2.570866'),
('ago/22', '2.565454'),
('set/22', '2.560055'),
('out/22', '2.554661'),
('nov/22', '2.549280'),
('dez/22', '2.543905'),
('jan/23', '2.538554'),
('fev/23', '2.533207'),
('mar/23', '2.527875'),
('abr/23', '2.527875');

UPDATE simulacao_periodo_trabalho sp
JOIN atualizacao_monetaria am ON sp.mes_ano = am.mes_ano
SET sp.salario_atualizado = sp.salario * am.indice_atualizacao
WHERE sp.salario > 0;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

select * from simulacao_beneficio;
select * from simulacao_periodo_trabalho;
select * from atualizacao_monetaria;

ALTER TABLE `previdenciaaquidb`.`simulacao_periodo_trabalho` DROP COLUMN `mes_ano`;
